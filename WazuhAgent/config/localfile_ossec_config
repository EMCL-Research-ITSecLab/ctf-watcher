<ossec_config>
  <localfile>
    <log_format>journald</log_format>
    <location>journald</location>
  </localfile>

  <localfile>
    <log_format>syslog</log_format>
    <location>/var/ossec/logs/active-responses.log</location>
  </localfile>

  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/dpkg.log</location>
  </localfile>

  <localfile>
    <log_format>json</log_format>
    <location>/var/lib/docker/volumes/heiDPI_var_log/_data/flow_event.json</location>
  </localfile>

  <localfile>
    <log_format>json</log_format>
    <location>/var/lib/docker/volumes/heiDPI_var_log/_data/packet_event.json</location>
  </localfile>

<!--Bash Command Log -->
  <localfile>
    <location>/var/log/commands.log</location>
    <log_format>syslog</log_format>
  </localfile>

<!-- CPU, memory, disk metric -->
  <localfile>
     <log_format>full_command</log_format>
     <command>echo $(top -bn1 | grep Cpu | awk '{print $2+$4+$6+$12+$14+$16}' ; free -m | awk 'NR==2{printf "%.2f\t\t\n", $3*100/$2 }' ; df -h | awk '$NF=="/"{print $5}'|sed 's/%//g')</command>
     <alias>general_health_metrics</alias>
     <out_format>$(timestamp) $(hostname) general_health_check: $(log)</out_format>
     <frequency>30</frequency>
  </localfile>

<!-- load average metrics -->
  <localfile>
     <log_format>full_command</log_format>
     <command>uptime | grep load | awk '{print $(NF-2),$(NF-1),$NF}' | sed 's/\,\([0-9]\{1,2\}\)/.\1/g'</command>
     <alias>load_average_metrics</alias>
     <out_format>$(timestamp) $(hostname) load_average_check: $(log)</out_format>
     <frequency>30</frequency>
  </localfile>

<!-- memory metrics -->
  <localfile>
     <log_format>full_command</log_format>
     <command>free --bytes| awk 'NR==2{print $3,$7}'</command>
     <alias>memory_metrics</alias>
     <out_format>$(timestamp) $(hostname) memory_check: $(log)</out_format>
     <frequency>30</frequency>
  </localfile>

<!-- disk metrics -->
  <localfile>
     <log_format>full_command</log_format>
     <command>df -B1 | awk '$NF=="/"{print $3,$4}'</command>
     <alias>disk_metrics</alias>
     <out_format>$(timestamp) $(hostname) disk_check: $(log)</out_format>
     <frequency>30</frequency>
  </localfile>

<!-- Current Active User Full-->
  <localfile>
     <log_format>command</log_format>
     <command>w -h | awk '{print $1,$2,$3,$4}'</command>
     <alias>current_active_users</alias>
     <out_format>$(timestamp) $(hostname) current_active_users: $(log)</out_format>
     <frequency>30</frequency>
  </localfile>

<!-- Current Active User -->
  <localfile>
     <log_format>full_command</log_format>
     <command>users | wc -w</command>
     <alias>current_active_user_number</alias>
     <out_format>$(timestamp) $(hostname) current_active_user_number: $(log)</out_format>
     <frequency>30</frequency>
  </localfile>

<!-- UFW Status -->
  <localfile>
     <log_format>command</log_format>
     <command>ufw status | awk 'NR>4'</command>
     <alias>ufw_status</alias>
     <out_format>$(timestamp) $(hostname) ufw_status: $(log)</out_format>
     <frequency>30</frequency>
  </localfile>


